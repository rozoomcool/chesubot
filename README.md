# CHESU bot
### –¢–µ–ª–µ–≥—Ä–∞–º–º –±–æ—Ç –¥–ª—è –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ —Ö–æ—Ç—è—Ç –æ–∑–Ω–∞–∫–æ–º–∏—Ç—å—Å—è —Å —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–æ–º.

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–Ω—ã–µ —Ç–µ—Ö–Ω–æ–ª–æ–≥–∏–∏
  - aiogram - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞, –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–µ–ª–µ–≥—Ä–∞–º–º –±–æ—Ç–æ–≤
  - python-dotenv - –ë–∏–±–ª–∏–æ—Ç–µ–∫–∞, –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–º–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª
  - –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏—è —Å —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞–º–∏ –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–µ—Ä–µ—á–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤ –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç
  - –ü—Ä–æ—Å–º–æ—Ç—Ä —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ —É–Ω–∏–≤–µ—Ä—Å–∏—Ç–µ—Ç–µ
  - –ü—Ä–æ—Å–º–æ—Ç—Ä –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π, –∫–æ—Ç–æ—Ä—ã–µ –µ—Å—Ç—å –≤ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞—Ö
  - –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏ —Å –≤–∏–¥–µ–æ-–∞–Ω–Ω–æ—Ç–∞—Ü–∏–µ–π –æ –∫–∞–∂–¥–æ–º —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–µ

#### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
  - main.py - –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª, –≤ –Ω–µ–º —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª –∑–∞–ø—É—Å–∫–∞ –±–æ—Ç–∞, –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –≤—Å–µ—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –∏ —Ä–æ—É—Ç–µ—Ä–æ–≤
  - config.py - –ü–æ–¥–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ environment
  - Dockerfile - –§–∞–π–ª –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ docker, –¥–ª—è —É–¥–æ–±–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –∏ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏—è –±–æ—Ç–∞ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
  - requirements.txt - –°–æ–¥–µ—Ä–∂–∏—Ç –ø–µ—Ä–µ—á–µ–Ω—å –±–∏–±–ª–∏–æ—Ç–µ–∫, –¥–ª—è —É–¥–æ–±—Å—Ç–≤–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏–º–∏
  - .env - –Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è
  - /callback - –°–æ–¥–µ—Ä–∂–∏—Ç –∫–æ–ª–ª–±—ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ –ø—Ä–µ–¥–Ω–æ–∑–Ω–∞—á–µ–Ω—ã –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π –∏–∑ –±–æ—Ç–∞
  - /keyboard - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä, –∫–æ—Ç–æ—Ä—ã–µ –±—É–¥—É—Ç –≤ –±–æ—Ç–µ
  - /resourse - –°–æ–¥–µ—Ä–∂–∏—Ç data.json, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–ø–æ–ª–Ω—è–µ—Ç —Ä–æ–ª—å –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö
  - /router - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–æ—É—Ç–µ—Ä–æ–≤ –≤ –±–æ—Ç–µ
  - /utils - –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

#### –ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã
  - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –±–æ—Ç–∞: `bot = Bot(config.TOKEN, parse_mode=ParseMode.HTML)`
  - –ü–æ–¥–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ data.json:
```
f = open(config.DATA_PATH, "r", encoding="utf_8_sig")
faculties_data = json.load(f)
```
  - –ò–Ω—ä–∫—Ü–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π, –¥–ª—è –∏–∑–±–µ–∂–∞–Ω–∏—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≥–ª–æ–±–∞–ª—å–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –∏ —É–ª—É—á—à–µ–Ω–∏—è —á–∏—Ç–∞–µ–º–æ—Å—Ç–∏ –∫–æ–¥–∞
```
dispatcher = Dispatcher(
    bot=bot,
    faculties_data=faculties_data["faculties"]
)
```
  - –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—É—Ç–µ—Ä–æ–≤
```
dispatcher.include_router(start_router)
dispatcher.include_router(faculties_router)
dispatcher.include_router(documents_router)
```
  - –ó–∞–ø—É—Å–∫ –ø–æ–ª–ª–∏–Ω–≥–∞ –±–æ—Ç–∞: `await dispatcher.start_polling(bot)`
  - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ –∑–∞–ø—É—Å–∫ –±–æ—Ç–∞ –≤ –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ–º —Ä–µ–∂–∏–º–µ
```
if __name__ == "__main__":
  logging.basicConfig(level=logging.INFO, stream=sys.stdout)
  asyncio.run(main())
```
  - –ö–æ–ª–ª–±—ç–∫–∏, –∫–æ—Ç–æ—Ä—ã–µ —Å–ª—É–∂–∞—Ç –¥–ª—è –≤—ã–∑–æ–≤–∞ —Ñ—É–Ω–∫—Ü–∏–π –∏ –ø–µ—Ä–µ–¥–∞—á–∏ –º–µ–∂–¥—É –Ω–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
```
class GetDocumentsCallbackFactory(CallbackData, prefix="documents"):
    pass
class GetFacultiesCallbackFactory(CallbackData, prefix="faculties"):
    pass
class GetWayInfoCallbackFactory(CallbackData, prefix="faculties"):
    faculty_id: int
    way_id: int
class GetWaysCallbackFactory(CallbackData, prefix="ways"):
    facultyId: int
class StartCallback(CallbackData, prefix="startt"):
    pass
```

#### –°—Ç–∞—Ä—Ç–æ–≤—ã–π —Ä–æ—É—Ç–µ—Ä
##### –ò–Ω–∏–∑–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞: `start_router = Router()`
##### –ï–Ω–¥–ø–æ–∏–Ω—Ç –¥–ª—è –∫–æ–º–∞–Ω–¥—ã /start
```
@start_router.message(CommandStart())
async def command_start(message: Message) -> None:
    await message.answer(
        f"–ü—Ä–∏–≤–µ—Ç, –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç {hbold(message.from_user.full_name)}",
        reply_markup=start_keyboard()
    )
```
##### –ö–æ–ª–ª–±—ç–∫, –∫–æ—Ç–æ—Ä—ã–π –≤—ã–∑—ã–≤–∞–µ—Ç —Ñ—É–∫–Ω—Ü–∏—é start
```
@start_router.callback_query(StartCallback.filter())
async def command_start(callback: CallbackQuery) -> None:
    await callback.message.delete()
    await callback.message.answer(
        f"–ü—Ä–∏–≤–µ—Ç, –∞–±–∏—Ç—É—Ä–∏–µ–Ω—Ç {hbold(callback.from_user.full_name)}",
        reply_markup=start_keyboard()
    )
```

#### –†–æ—É—Ç–µ—Ä —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ö
##### –ò–Ω–∏–∑–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞: `documents_router = Router()`
##### –ö–æ–ª–ª–±—ç–∫ –¥–ª—è –≤—ã–¥–∞—á–∏ –ø–µ—Ä–µ—á–Ω—è –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤
```
@documents_router.callback_query(GetDocumentsCallbackFactory.filter())
async def process_get_documents(callback: CallbackQuery):
    await callback.message.delete()
    await callback.message.answer(texts.documents_info, reply_markup=document_keyboard())
```

#### –†–æ—É—Ç–µ—Ä —Å –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –æ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–∞—Ö –∏ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏—è—Ö
##### –ò–Ω–∏–∑–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–æ—É—Ç–µ—Ä–∞: `faculties_router = Router()`
##### –ö–æ–ª–ª–±—ç–∫ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–ø–∏—Å–∫–∞ —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤
```
@start_router.message(CommandStart())
@faculties_router.callback_query(GetFacultiesCallbackFactory.filter())
async def process_get_faculties(callback: CallbackQuery, faculties_data: List[dict]):
    await callback.message.delete()
    await callback.message.answer("–ü–µ—Ä–µ—á–µ–Ω—å —Ñ–∞–∫—É–ª—å—Ç–µ—Ç–æ–≤:\n", reply_markup=faculty_keyboard(faculties_data))

```
##### –ö–æ–ª–ª–±—ç–∫ –¥–ª—è –ø–æ–ª—É—á–Ω–∏—è —Å–ø–∏—Å–∫–∞ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π
```
@faculties_router.callback_query(GetWaysCallbackFactory.filter())
async def process_get_ways(callback: CallbackQuery, callback_data: GetWaysCallbackFactory, faculties_data: List[dict]):
    await callback.message.delete()
    await callback.message.answer("–ü–µ—Ä–µ—á–µ–Ω—å –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–π",
                                  reply_markup=way_keyboard(faculties_data, faculty_id=callback_data.facultyId,
                                  callback_data=callback_data))

```
##### –ö–æ–ª–ª–±—ç–∫ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–∏, —Å –≤–∏–¥–µ–æ–∞–Ω–æ–Ω—Å–æ–º
```
@faculties_router.callback_query(GetWayInfoCallbackFactory.filter())
async def process_get_faculties(callback: CallbackQuery, callback_data: GetWayInfoCallbackFactory,
                                faculties_data: List[dict]):
    await callback.message.delete()
    faculty_data = list(filter(lambda x: x["id"] == callback_data.faculty_id, faculties_data))[0]
    way_data = list(filter(lambda x: x["id"] == callback_data.way_id, faculty_data["ways"]))[0]
    text = f"{hlink(title=' ', url=faculty_data["video"])}{hbold(way_data['faculty'])}\n" + way_data["info"]
    await callback.message.answer(text, reply_markup=back_keyboard(GetWaysCallbackFactory(facultyId=callback_data.faculty_id)))
```

#### –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–ª–∞–≤–∏–∞—Ç—É—Ä –≤ –±–æ—Ç–µ
```
def faculty_keyboard(data: List[dict]):
    builder = InlineKeyboardBuilder()
    for i, faculty in enumerate(data):
        builder.button(
            text=faculty["name"],
            callback_data=GetWaysCallbackFactory(facultyId=int(faculty["id"]))
        )
    builder.adjust(2)
    builder.button(
        text="üîô –ù–∞–∑–∞–¥",
        callback_data=StartCallback()
    )
    builder.adjust(1)

    return builder.as_markup()


def document_keyboard():
    builder = InlineKeyboardBuilder()
    builder.button(
        text="üîô –ù–∞–∑–∞–¥",
        callback_data=StartCallback()
    )
    builder.adjust(1)

    return builder.as_markup()


def back_keyboard(callback_data):
    builder = InlineKeyboardBuilder()
    builder.button(
        text="üîô –ù–∞–∑–∞–¥",
        callback_data=callback_data
    )
    builder.adjust(1)

    return builder.as_markup()


def way_keyboard(data: List[dict], faculty_id: int, callback_data):
    builder = InlineKeyboardBuilder()
    for i, faculty in enumerate(list(filter(lambda d: d["id"] == faculty_id, data))[0]["ways"]):
        builder.button(
            text=faculty["faculty"],
            callback_data=GetWayInfoCallbackFactory(way_id=faculty["id"], faculty_id=faculty_id)
        )
    builder.adjust(2)
    builder.button(
        text="üîô –ù–∞–∑–∞–¥",
        callback_data=GetFacultiesCallbackFactory()
    )

    return builder.as_markup()

def start_keyboard():
    builder = InlineKeyboardBuilder()
    builder.button(
        text="–í—ã–±—Ä–∞—Ç—å –∏–Ω—Å—Ç–∏—Ç—É—Ç",
        callback_data=GetFacultiesCallbackFactory()
    )
    builder.button(
        text="–î–æ–∫—É–º–µ–Ω—Ç—ã –¥–ª—è –ø–æ—Å—Ç—É–ø–ª–µ–Ω–∏—è",
        callback_data=GetDocumentsCallbackFactory()
    )
    builder.adjust(2)

    return builder.as_markup()
```







